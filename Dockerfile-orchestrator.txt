# Multi-stage build para orquestrador
FROM python:3.12-slim AS builder
WORKDIR /app
RUN pip install uv
COPY pyproject.toml .
RUN uv sync --all-extras

FROM gcr.io/distroless/python3-debian12
WORKDIR /app
COPY --from=builder /app/.venv /app/.venv
COPY services/orchestrator/src /app/src
ENV PATH="/app/.venv/bin:$PATH"
CMD ["python", "src/agent.py"]